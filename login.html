<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Log In</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="Logo_v4.ico" type="image/x-icon"> 
</head>
<body>
    <h2>Welcome to QwertyNavy's awesome cloud storage! This is intended as a way to store your save codes for MSMiS and DOFiS.</h2>
  <div>
    <h1>Log In</h1>

    <input id="username" placeholder="Username"><br>
    <input id="password" placeholder="Password" type="password"><br>
    <button id="login">Log In</button>

    <!-- Error display -->
    <div id="error" class="error"></div>

    <!-- Navigation link -->
    <p style="margin-top:15px;">
      <a href="index.html" class="link">Don't have a Cloud Save? Sign up</a>
    </p>
  </div>

  <script type="module">
    import { auth, signInWithEmailAndPassword } from "./firebase.js";

    const errorDiv = document.getElementById("error");

    document.getElementById("login").onclick = async () => {
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      errorDiv.innerText = "";

      if (!username || !password) {
        errorDiv.innerText = "Please enter both username and password.";
        return;
      }

      const email = username + "@mysite.fake";

      try {
        await signInWithEmailAndPassword(auth, email, password);
        localStorage.setItem("username", username);
        window.location = "account.html";
      } catch (e) {
        errorDiv.innerText = e.message;
      }
    };
  </script>
</body>
</html>
